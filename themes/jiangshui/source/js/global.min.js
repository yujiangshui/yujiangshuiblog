/*! Jiangshui hexo 20-11-2014 */
var G={},share;G.fadeInByOrder=function(a,b,c){var d=1,e=$(a+" .fade").length+1,f=b||100,g=c||function(){};!function(){e>d&&($(a+" .fade"+d).addClass("fade-in"),d++,setTimeout(arguments.callee,f),d===e&&g())}()},G.getTLItemTops=function(){var a=[];return $(".timeline-item").each(function(){a.push($(this).offset().top)}),a},G.justOnce1=!1,G.justOnce2=!0,function(a){a(document).ready(function(){if(G.getWindowHeight=function(){return a(window).height()},G.getDocumentHeight=function(){return a(document).height()},G.windowHeight=G.getWindowHeight(),G.documentHeight=G.getDocumentHeight(),a(".timeline").length){var b=a(".section-menu").height(),c=a(".section-footer").outerHeight(!0)+120+a(".need-work").height();G.timelineOffsetTop=a(".timeline-works").offset().top-b,a(".line-block").css({top:b}),a(".need-work").css({"margin-top":G.windowHeight/2-c}),G.timelineItemOffsets=G.getTLItemTops(),a(".timeline-item").each(function(){var b=a(this).find(".timeline-excerpt").height();a(this).find(".timeline-detail p").height(b)})}a(document).ajaxStart(function(){a(".loading").show(),a(".loading-overlay").stop(!0).fadeIn(200)}).ajaxStop(function(){a(".loading").hide(),a(".loading-overlay").stop(!0).fadeOut(200)}),G.headerHeight=a(".section-header").outerHeight(!0)+a(".section-menu").outerHeight(!0)-a(".section-menu").height(),G.navWidth=a(".section-menu .section").width(),G.windowWidth=a(window).width(),G.expendLength=G.windowWidth-G.navWidth,a(".back-to-top").click(function(){a("html,body").animate({scrollTop:0},200)})}),a(window).load(function(){G.documentHeight=G.getDocumentHeight(),a(".timeline").length&&(G.timelineItemOffsets=G.getTLItemTops())}),a(window).scroll(function(){var b=a(window).scrollTop();b>200?a(".back-to-top").fadeIn(200):a(".back-to-top").fadeOut(200);var c=b/G.headerHeight;b<G.headerHeight&&b>=0?(a(".section-menu .section").css({"max-width":G.navWidth+G.expendLength*c}),a(".section-menu").removeClass("fixed")):b>G.headerHeight&&b>=0&&a(".section-menu").addClass("fixed");var d=800;if(a(".list-pagination").length&&b>G.documentHeight-d){var e=a(".page-number.current").next(".page-number").attr("href");e&&(G.justOnce1||(G.justOnce1=!0,a.ajax({type:"GET",url:e}).done(function(b){var c=a("<div>").html(b).find(".list-blog").html(),d=a("<div>").html(b).find(".list-pagination").html();a(".list-blog").append(c),a(".list-pagination").html(d),G.justOnce1=!1,G.documentHeight=G.getDocumentHeight()}).fail(function(a,b){G.justOnce1=!0,console.log(b)})))}if(a(".timeline").length){var f=G.windowHeight/2-60;if(b>G.timelineOffsetTop&&b<G.timelineOffsetTop+f?a(".line-block").show().height(b-G.timelineOffsetTop):b>=G.timelineOffsetTop+f?G.justOnce2&&(a(".line-block").height(f),G.justOnce2=!1):b<=G.timelineOffsetTop&&a(".line-block").hide(),a(".timeline-item").length&&b>G.timelineOffsetTop)for(var g=a(".line-block").offset().top+a(".line-block").height(),h=0;h<G.timelineItemOffsets.length;h++)g>G.timelineItemOffsets[h]&&g<G.timelineItemOffsets[h+1]?(a(".timeline-item").removeClass("current"),a(".timeline-item:eq("+h+")").addClass("current")):g<G.timelineItemOffsets[0]?a(".timeline-item").removeClass("current"):g>G.timelineItemOffsets[G.timelineItemOffsets.length-1]&&(a(".timeline-item").removeClass("current"),a(".timeline-item:eq("+parseInt(G.timelineItemOffsets.length-1)+")").addClass("current"))}})}(jQuery);